<div class="bd-main">
    <div class="bd-toc mt-4 mb-5 my-md-0 ps-xl-3 mb-lg-5 text-muted">
        <strong class="d-block h6 my-2 pb-2 border-bottom">On this page</strong>
        <nav class="table-of-contents">
            <ul>
                <li>
                    <a [routerLink]="['.']" fragment="apikey" [ngClass]="{'active': current === 'apikey' }">apiKey</a>
                </li>
                <li>
                    <a [routerLink]="['.']" fragment="user-agent"
                        [ngClass]="{'active': current === 'user-agent' }">UserAgent</a>
                </li>
                <li>
                    <a [routerLink]="['.']" fragment="session"
                        [ngClass]="{'active': current === 'session' }">Session</a>

                    <ul>
                        <li>
                            <a [routerLink]="['.']" fragment="authentication"
                                [ngClass]="{'active': current === 'authentication' }">Authentication</a>
                        </li>
                        <li>
                            <a [routerLink]="['.']" fragment="presence"
                                [ngClass]="{'active': current === 'presence' }">Presence, Groups</a>
                        </li>
                    </ul>
                </li>

                <li>
                    <a [routerLink]="['.']" fragment="conversation"
                        [ngClass]="{'active': current === 'conversation' }">Conversation</a>
                </li>
                <li>
                    <a [routerLink]="['.']" fragment="moderation"
                        [ngClass]="{'active': current === 'moderation' }">Moderation</a>
                </li>
                <li>
                    <a [routerLink]="['.']" fragment="local-streams"
                        [ngClass]="{'active': current === 'local-streams' }">Local Streams</a>
                    <ul>
                        <li>
                            <a [routerLink]="['.']" fragment="camera"
                                [ngClass]="{'active': current === 'camera' }">Camera</a>
                        </li>
                        <li>
                            <a [routerLink]="['.']" fragment="screen-sharing"
                                [ngClass]="{'active': current === 'screen-sharing' }">Screen sharing</a>
                        </li>
                        <li>
                            <a [routerLink]="['.']" fragment="publish-unpublish"
                                [ngClass]="{'active': current === 'publish-unpublish' }">Publish/Unpublish</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a [routerLink]="['.']" fragment="remote-streams"
                        [ngClass]="{'active': current === 'remote-streams' }">Remote Streams</a>
                </li>
                <li>
                    <a [routerLink]="['.']" fragment="stream-display"
                        [ngClass]="{'active': current === 'stream-display' }">Stream display</a>
                </li>
                <li>
                    <a [routerLink]="['.']" fragment="stream-capabilities"
                        [ngClass]="{'active': current === 'stream-capabilities' }">Stream capabilities</a>
                    <ul>
                        <li>
                            <a [routerLink]="['.']" fragment="capabilities-local"
                                [ngClass]="{'active': current === 'capabilities-local' }">Local stream</a>
                        </li>
                        <li>
                            <a [routerLink]="['.']" fragment="capabilities-remote"
                                [ngClass]="{'active': current === 'capabilities-remote' }">Remote stream</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a [routerLink]="['.']" fragment="qos-statistics"
                        [ngClass]="{'active': current === 'qos-statistics' }">QoS Statistics</a>
                </li>
                <li>
                    <a [routerLink]="['.']" fragment="speaker-detection"
                        [ngClass]="{'active': current === 'speaker-detection' }">Speaker Detection</a>
                </li>
                <li>
                    <a [routerLink]="['.']" fragment="mute" [ngClass]="{'active': current === 'mute' }">Audio/Video
                        Mute</a>
                </li>
                <li>
                    <a [routerLink]="['.']" fragment="whiteboard"
                        [ngClass]="{'active': current === 'whiteboard' }">Whiteboard</a>
                </li>
                <li>
                    <a [routerLink]="['.']" fragment="recording"
                        [ngClass]="{'active': current === 'recording' }">Recording</a>
                </li>
                <li>
                    <a [routerLink]="['.']" fragment="chat-messages"
                        [ngClass]="{'active': current === 'chat-messages' }">Chat messages</a>
                </li>
                <li>
                    <a [routerLink]="['.']" fragment="background-subtraction"
                        [ngClass]="{'active': current === 'background-subtraction' }">Background
                        subtraction</a>
                </li>
                <li>
                    <a [routerLink]="['.']" fragment="good-practices"
                        [ngClass]="{'active': current === 'good-practices' }">Good practices</a>
                    <ul>
                        <li>
                            <a [routerLink]="['.']" fragment="uptodate"
                                [ngClass]="{'active': current === 'uptodate' }">Keeping Up-to-Date</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>
    </div>
    <div class="bd-content">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-10 fs-5">
                    <p class="text-center">
                        This guide covers all concepts and features to develop your communication
                        <strong>client application</strong> with <strong>ApiRTC</strong>.
                    </p>
                </div>
            </div>
            <h1 class="mt-5">
                <a #anchor id="apikey" class="anchor"></a>
                apiKey
            </h1>
            <p>
                The <strong>apiKey</strong> is a 32 characters string associated with an <strong>Enterprise</strong>. It
                allows associating <strong>ApiRTC</strong> usage with your project for quota and billing.
            </p>
            <p>
                An <strong>apiKey</strong> is required to start using the client <strong>ApiRTC APIs</strong>.
            </p>
            <div class="alert alert-info d-flex align-items-center" role="alert">
                <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Info:">
                    <use xlink:href="#info-fill"></use>
                </svg>
                <div>
                    Create an <strong>account</strong> on <a href="https://cloud.apirtc.com" title="Get apiKey"
                        target="_blank" rel="noopener">https://cloud.apirtc.com&nbsp;<span
                            class="material-icons align-middle fs-6">open_in_new</span></a>
                    and get your <strong>apiKey</strong> from <a class="text-nowrap"
                        href="https://cloud.apirtc.com/enterprise/api" target="_blank"
                        rel="noopener">https://cloud.apirtc.com/enterprise/api&nbsp;<span
                            class="material-icons align-middle fs-6">open_in_new</span></a>
                </div>
            </div>
            <h1 class="mt-5">
                <a #anchor id="user-agent" class="anchor"></a>
                UserAgent
            </h1>
            <p>
                The <a href="https://dev.apirtc.com/reference/UserAgent.html" target="_blank"
                    rel="noopener"><code>UserAgent</code>&nbsp;<span
                        class="material-icons align-middle fs-6">open_in_new</span></a> is an entrypoint to
                <strong>ApiRTC</strong>. This is the first object to
                instantiate. It represents the <strong>local user</strong> that will participate to communications.
            </p>
            <p class="mt-3">
                There are two ways to instantiate a <code>UserAgent</code>:
            </p>
            <div class="row">
                <div class="col">
                    <div class="card border-secondary">
                        <div class="card-body text-secondary">
                            <h3 class="card-title">
                                with apiKey
                            </h3>
                            <div class="card-text">
                                <p>
                                    This method is useful to use <strong>ApiRTC</strong> anonymously, or with external
                                    user management.
                                </p>
                                <p>
                                    In this case the <code>uri</code> is <strong>apiKey</strong> prefixed with "apzkey:"
                                    string:
                                </p>
                                <app-codenav [code]="useragent_apikey" [(language)]="lang">
                                </app-codenav>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="card border-secondary">
                        <div class="card-body text-secondary">
                            <h3 class="card-title">
                                with username
                            </h3>
                            <div class="card-text">
                                <p>
                                    This method is useful to further authenticate with
                                    <strong>ApiRTC</strong>&nbsp;<strong>User</strong> management.
                                </p>
                                <p>
                                    In this case the <code>uri</code> is <strong>username</strong> prefixed with
                                    "apizee:" string:
                                </p>
                                <app-codenav [code]="useragent_apirtc" [(language)]="lang">
                                </app-codenav>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <h2 class="mt-3">
                UserData
            </h2>
            <p>
                <code>UserData</code> is a class that holds a data object to store values associated to a
                <code>UserAgent</code>. Make sure to call <code>UserData.setProp(key, value)</code> to set a property.
            </p>
            <p>
                Once connected to <code>Session</code>, call <code>userData.setToSession()</code> to make other
                connected peers notified of <code>UserData</code> properties change through the
                <code>Session.contactListUpdate</code> event.
            </p>
            <p>
                For that purpose, the data object associated to <code>Session.contactListUpdate</code>
                event has a <code>userDataChanged</code> property which is an array of
                <code>Contact</code>s for which <code>UserData</code> has changed.
            </p>
            <h2>
                MediaDevices
            </h2>
            <p>
                <code>UserAgent</code>'s <code>mediaDeviceChanged</code> event can be listened to in order to get
                notified of the list of devices available to the browser:
            </p>
            <app-codenav [code]="mediaDeviceChanged" [(language)]="lang"></app-codenav>
            <p class="mt-3">
                Here is what the <code>mediaDevices</code> object looks like:
            </p>
            <pre><code [highlight]="mediaDevices_json" [languages]="['json']"></code></pre>
            <p class="mt-3">
                This is useful to propose a list of available media devices to the user.
            </p>
            <h1 class="mt-5">
                <a #anchor id="session" class="anchor"></a>
                Session
            </h1>
            <p>
                A <a href="https://dev.apirtc.com/reference/Session.html" target="_blank"
                    rel="noopener"><code>Session</code>&nbsp;<span
                        class="material-icons align-middle fs-6">open_in_new</span></a> instance is obtained when
                connecting to the ApiRTC platform.
            </p>
            <p>
                A <strong>session</strong> with <strong>ApiRTC</strong> platform needs to be established in order to
                access
                connected features of <strong>ApiRTC</strong> such as chat or video conferencing.
            </p>
            <p>
                This is done through the <code>UserAgent.register(options)</code> method.
            </p>
            <p>
                <code>options</code> parameter controls the authentication mechanism.
            </p>
            <div class="alert alert-info d-flex align-items-center" role="alert">
                <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Info:">
                    <use xlink:href="#info-fill"></use>
                </svg>
                <div>
                    Configure the required authentication by <strong>Enterprise</strong> (thus by
                    <strong>apiKey</strong>), from your <strong>account</strong> panel: <a
                        href="https://cloud.apirtc.com/enterprise/users-authentication" title="Configure authentication"
                        target="_blank" rel="noopener">API/Authentication&nbsp;<span
                            class="material-icons align-middle fs-6">open_in_new</span></a>.
                </div>
            </div>
            <h2>
                <a #anchor id="authentication" class="anchor"></a>
                Authentication
            </h2>
            <p>
                Getting a <strong>session</strong> supports the following <strong>authentication</strong> mechanisms:
            </p>
            <div class="row align-items-center">
                <div class="col-sm-12 col-xl-4">
                    <div class="card border-secondary mb-3">
                        <div class="card-body text-secondary">
                            <h3 class="card-title">
                                No auth
                            </h3>
                            <app-codenav [code]="register_noauth" [(language)]="lang"></app-codenav>
                            <p class="card-text">
                                <br />
                                on a <code>UserAgent</code> created with <strong>apiKey</strong>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-sm-12 col-xl-4">
                    <div class="card-text">
                        <div class="row">
                            <div class="col">
                                <div class="card border-secondary mb-3">
                                    <div class="card-body text-secondary">
                                        <h3 class="card-title" id="h5__278552043">
                                            External user management JWT (JSON Web Token)
                                        </h3>
                                        <app-codenav [code]="register_jwt" [(language)]="lang">
                                        </app-codenav>
                                        <p class="card-text">
                                            on a <code>UserAgent</code> created with <strong>apiKey</strong>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- <div class="row">
                            <div class="col">
                                <div class="card border-secondary mb-3">
                                    <div class="card-body text-secondary">
                                        <h3 class="card-title">
                                            External user management 3rdParty Auth server
                                        </h3>
                                        <app-codenav [code]="register_3rdparty" [(language)]="lang">
                                        </app-codenav>
                                        <p class="card-text">
                                            &nbsp;on a <code>UserAgent</code> created with
                                            <strong>apiKey</strong>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div> -->
                    </div>
                </div>
                <div class="col-sm-12 col-xl-4">
                    <div class="card border-secondary mb-3">
                        <div class="card-body text-secondary">
                            <h3 class="card-title">
                                ApiRTC user management
                            </h3>
                            <app-codenav [code]="register_apirtc" [(language)]="lang"></app-codenav>
                            <p class="card-text">
                                on a <code>UserAgent</code> created with <strong>username</strong>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <h1 class="mt-5">
                <a #anchor id="presence" class="anchor"></a>
                Presence, Groups
            </h1>
            <p>
                In an <strong>ApiRTC</strong> client application, remote users are <code>Contact</code>s.
            </p>
            <p>
                The <strong>presence</strong> feature allows to get notified to all users
                currently connected with same <strong>apiKey</strong>.
            </p>
            <p>
                Listening on <code>Session.contactListUpdate</code> event notifies on <code>Contact</code>, connected
                with to same <strong>Enterprise</strong>(<strong>apiKey</strong>), that joined, left, or for which
                <code>UserData</code> changed.
            </p>
            <p>
                A notion of <strong>groups</strong> comes with this feature for better control. To make a user connect
                within some group, set the <code>RegisterInformation.groups</code> in the
                <code>UserAgent.register()</code> options.
            </p>
            <app-codenav [code]="contactListUpdate" [(language)]="lang"></app-codenav>
            <h1 class="mt-5">
                <a #anchor id="conversation" class="anchor"></a>
                Conversation
            </h1>
            <p>
                A <strong>conversation</strong> is the way to gather participants to exchange medias. It can be text
                message, audio/video streams, files...
            </p>
            <p>
                Whenever there are 2 participants or more, a <strong>conversation</strong> takes place.
            </p>
            <h2>
                getOrCreate
            </h2>
            <p>
                To get a <a href="https://dev.apirtc.com/reference/Conversation.html" target="_blank"
                    rel="noopener"><code>Conversation</code>&nbsp;<span
                        class="material-icons align-middle fs-6">open_in_new</span></a> instance, the
                <code>Session</code> method
                <a href="https://dev.apirtc.com/reference/Session.html#getOrCreateConversation__anchor" target="_blank"
                    rel="noopener">getOrCreateConversation(name, options)&nbsp;<span
                        class="material-icons align-middle fs-6">open_in_new</span></a> shall be used.
            </p>
            <p>
                The <code>name</code> is a free string.
            </p>
            <div class="row align-items-center mt-3">
                <div class="col">
                    <app-codenav [code]="getOrCreateConversation" [(language)]="lang"></app-codenav>
                </div>
                <div class="col border-start">
                    <p>
                        <code>meshModeEnabled</code> enables the mesh mode (otherwise SFU star topology is used by
                        default).
                    </p>
                    <p>
                        The stream exchanges will remain in this mode until:
                    </p>
                    <ul>
                        <li>
                            the number of participant goes over 4,
                        </li>
                        <li>
                            or too many packet loss is detected for one participant.
                        </li>
                    </ul>
                    <p>
                        Then the <strong>conversation</strong> will automatically switch to star topology mode using
                        ApiRTC SFUs infrastructure.
                    </p>
                    <p>
                        Setting both <code>meshModeEnabled</code> and <code>meshOnlyEnabled</code> to <code>true</code>
                        forces the <strong>conversation</strong> to remain mesh only.
                    </p>
                    <div class="alert alert-info d-flex align-items-center" role="alert">
                        <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Info:">
                            <use xlink:href="#info-fill"></use>
                        </svg>
                        <div>
                            Check <a routerLink="../architecture" title="link to SFUs">Architecture</a> to learn
                            about how <strong>ApiRTC</strong> handles
                            small and large <code>Conversation</code>s.
                        </div>
                    </div>
                    <p>
                        <code>moderationEnabled</code> enables <strong>moderation</strong> on the
                        <code>Conversation</code> to create. This option may change the behavior of the joining process
                        depending on whether <code>moderator</code> option is true or false. Note that
                        every party must enable this option to have consistent moderation.
                    </p>
                    <p>
                        <code>moderator</code> adds the <strong>local user</strong> to the list of moderators for the
                        <strong>conversation</strong>.
                    </p>
                </div>
            </div>

            <h2>
                Join
            </h2>
            <p>
                <code>Conversation.join()</code> makes the local user enter the <strong>conversation</strong>. Note that
                this method returns a <code>Promise</code> and one must wait for it to be fulfilled before doing
                anything else on the <strong>conversation</strong>.
            </p>
            <p>
                A good practice is to register all required <code>Conversation</code> event listeners before calling the
                <code>join</code> method:
            </p>
            <app-codenav [code]="conversationJoin" [(language)]="lang"></app-codenav>
            <h2>
                Leave
            </h2>
            <p>
                <code>Conversation.leave()</code> makes the local user leave the <strong>conversation</strong>. All
                ongoing calls will be automatically closed.
            </p>
            <p>
                A good practice is to destroy the <code>Conversation</code> after leaving it.
            </p>
            <app-codenav [code]="conversationLeaveAndDestroy" [(language)]="lang"></app-codenav>
            <h1 class="mt-5">
                <a #anchor id="moderation" class="anchor"></a>
                Moderation
            </h1>
            <p>
                When enabled, <strong>moderation</strong> allows a group of users (<strong>moderators</strong>) to
                control who is allowed to participate to the <strong>conversation</strong>.
            </p>
            <h2>
                Activation
            </h2>
            <p>
                In order to activate the <strong>moderation</strong> for a <strong>conversation</strong>, every party
                (<strong>moderator</strong> or not) must explicitly set the <code>moderationEnabled</code> option to
                <code>true</code>
                when calling <a href="https://dev.apirtc.com/reference/Session.html#getOrCreateConversation__anchor"
                    target="_blank" rel="noopener">getOrCreateConversation&nbsp;<span
                        class="material-icons align-middle fs-6">open_in_new</span></a>.
            </p>
            <p>
                Additionally, a party that shall be a <strong>moderator</strong> must set the <code>moderator</code>
                option to
                <code>true</code> as well.
            </p>
            <!-- <h2>
                Moderators
            </h2>
            <p>
                <strong>Moderators</strong> do not require any kind of permissions from other participants to join the
                <strong>conversation</strong>.
            </p> -->
            <h2>Joining process</h2>
            <p>If the <strong>local user</strong> is <strong>moderator</strong>, then the <code>join()</code> will
                resolve immediately.
            </p>
            <p>But if the <strong>local user</strong> is not <strong>moderator</strong>, then the <code>join()</code>
                will only resolve when a <strong>moderator</strong> allows it. In the meanwhile, the user will be put in
                a <strong>waiting room</strong>.</p>
            <!-- <h2>
                Guests
            </h2>
            <p>
                Guests are non-moderators. Guests must received permission from one of the moderators to join the
                <strong>conversation</strong>.
            </p> -->
            <h2>
                Waiting Room
            </h2>
            <p>
                The <strong>waiting room</strong> is a presence group associated to the <strong>conversation</strong>
                and it allows to know which participants are currently waiting for a moderation answer.</p>
            <p>Events <code>contactJoinedWaitingRoom</code> and <code>contactLeftWaitingRoom</code> will be triggered
                respectively upon the arrival and departure of a user to/from the <strong>waiting room</strong>:
            </p>
            <app-codenav [code]="conversationModeratorWaitingRoom" [(language)]="lang"></app-codenav>
            <p>Then the <strong>moderator</strong> can allow or deny a contact to enter the
                <strong>conversation</strong>:
            </p>
            <app-codenav [code]="conversationAllowDenyEntry" [(language)]="lang"></app-codenav>
            <!-- <p>
                One may choose between 2 solutions in order to grant or deny access to other participants:
            </p>
            <ul>
                <li>register to <code>contactJoinedWaitingRoom</code> and <code>contactLeftWaitingRoom</code> event
                    listeners (on <code>Conversation</code>), or</li>
                <li>register to <code>conversationJoinRequest</code> event listener (on <code>Session</code>).</li>
            </ul> -->
            <!-- <h3>
                Solution 2: Join Request
            </h3>
            <p>
                When a guest wants to join a <strong>Conversation</strong>, a request will be sent every 5 seconds to
                all moderators until it is either accepted or denied. <code>conversationJoinRequest</code> will be
                triggered upon reception of each and every one of those requests.
            </p>
            <app-codenav [code]="conversationModeratorJoinRequest" [(language)]="lang"></app-codenav>
            <p>
                Both solutions may be used at the same time.
            </p> -->

            <h2>
                Eject
            </h2>
            <p>
                Moderators have the ability to eject another participant from the <strong>conversation</strong>.
            </p>
            <app-codenav [code]="conversationModeratorEject" [(language)]="lang"></app-codenav>
            <p>To get notified of a participant ejection, listen on the <code>participantEjected</code> event. The event
                data object wears a <code>self</code> boolean set to true if the current <strong>local user</strong>
                is the ejected participant.</p>
            <app-codenav [code]="conversationParticipantEjected" [(language)]="lang"></app-codenav>

            <h1 #localStreams class="mt-5">
                <a #anchor id="local-streams" class="anchor"></a>
                Local Streams
            </h1>
            <h2 class="mt-3">
                <a #anchor id="camera" class="anchor"></a>
                Camera
            </h2>
            <p>
                Acquiring <strong>camera local stream</strong> is done through the
                <code>UserAgent.createStream(options)</code> method. The browser asks the user to choose among available
                media devices. The <code>Promise</code> resolves with a <a
                    href="https://dev.apirtc.com/reference/Stream.html" target="_blank"
                    rel="noopener"><code>Stream</code>&nbsp;<span
                        class="material-icons align-middle fs-6">open_in_new</span></a> instance.
            </p>
            <div class="row align-items-center mt-3">
                <div class="col">
                    <app-codenav [code]="createStream" [(language)]="lang"></app-codenav>
                </div>
                <div class="col border-start">
                    <p>
                        Possible <code>options</code> (<a
                            href="https://dev.apirtc.com/reference/global.html#CreateStreamOptions" target="_blank"
                            rel="noopener"><code>CreateStreamOptions</code>&nbsp;<span
                                class="material-icons align-middle fs-6">open_in_new</span></a>) are:
                    </p>
                    <pre><code [highlight]="createStream_options" [languages]="['javascript']"></code></pre>
                    <p>
                        <!-- https://developer.mozilla.org/en-US/docs/Web/API/MediaStreamConstraints -->
                        <code>constraints</code> is of type <a
                            href="https://www.w3.org/TR/mediacapture-streams/#dom-mediastreamconstraints"
                            target="_blank" rel="noopener">MediaStreamConstraints&nbsp;<span
                                class="material-icons align-middle fs-6">open_in_new</span></a>
                    </p>
                    <p>
                        <code>filters</code> is an array of type <a
                            href="https://dev.apirtc.com/reference/global.html#FilterDescriptor" target="_blank"
                            rel="noopener">FilterDescriptor&nbsp;<span
                                class="material-icons align-middle fs-6">open_in_new</span></a>
                    </p>
                </div>
            </div>
            <h2 class="mt-3">
                <a #anchor id="screen-sharing" class="anchor"></a>
                Screen sharing
            </h2>
            <p>Acquiring screen sharing <strong>local stream</strong> is done through a <code>Stream</code> static
                method:</p>
            <app-codenav [code]="screenSharing" [(language)]="lang"></app-codenav>
            <h2 class="mt-3">
                <a #anchor id="publish-unpublish" class="anchor"></a>
                Publish/Unpublish
            </h2>
            <p>
                Publishing a <strong>local stream</strong> makes it available for remote peer participants to subscribe
                and view it.
            </p>
            <p>
                The <strong>local user</strong> (<code>UserAgent</code>) must have joined the conversation to publish a
                <strong>stream</strong>.
            </p>
            <app-codenav [code]="publish" [(language)]="lang"></app-codenav>
            <h3>
                PublishOptions
            </h3>
            <p>
                <code>Conversation.publish(stream, options)</code> can take optionally take <code>PublishOptions</code>
                second parameter object to control publication.
                Please check reference for details on <a
                    href="https://dev.apirtc.com/reference/global.html#PublishOptions" target="_blank"
                    rel="noopener">PublishOptions&nbsp;<span
                        class="material-icons align-middle fs-6">open_in_new</span></a>
            </p>
            <p>
                Unpublishing a <strong>local stream</strong> makes it unavailable for remote peer participants to
                subscribe and stops sending <strong>media stream</strong> to peers.
            </p>
            <app-codenav [code]="unpublish" [(language)]="lang"></app-codenav>
            <h1 class="mt-5">
                <a #anchor id="remote-streams" class="anchor"></a>
                Remote Streams
            </h1>
            <h2>
                Handle remote streams availability
            </h2>
            <p>
                <strong>ApiRTC</strong> notifies when stream availability changes through the
                <code>Conversation.streamListChanged</code> event.
            </p>
            <p>
                This event is triggered once for each existing <strong>stream</strong>, and then again every time a new
                <strong>stream</strong> is published to the <strong>conversation</strong>.
            </p>
            <div class="alert alert-warning" role="alert">
                <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Warning:">
                    <use xlink:href="#exclamation-triangle-fill"></use>
                </svg>
                <span>The data object carried by <code>Conversation.streamListChanged</code> event is
                    <code>StreamInfo</code>: this is not a <code>Stream</code>
                    yet.</span>
            </div>
            <app-codenav [code]="streamListChanged" [(language)]="lang"></app-codenav>
            <p>
                The <code>streamInfo.contact.getId()</code> and <code>streamInfo.streamId</code> can be useful to
                identify remote which <strong>peer</strong> published one <strong>stream</strong>.
            </p>
            <h2>
                Subscribe
            </h2>
            <p>
                A <strong>remote stream</strong> is subscribed to using the
                <code>Conversation.subscribeToStream(streamId)</code> method. It takes the id of stream provided in the
                <code>StreamInfo</code> data object:
            </p>
            <app-codenav [code]="subscribe" [(language)]="lang"></app-codenav>
            <h3>
                SubscribeOptions
            </h3>
            <p>
                <code>Conversation.subscribeToStream(streamId, options)</code> can take optionally take
                <a class="text-nowrap" href="https://dev.apirtc.com/reference/global.html#SubscribeOptions"
                    target="_blank" rel="noopener"><code>SubscribeOptions</code>&nbsp;<span
                        class="material-icons align-middle fs-6">open_in_new</span></a> second parameter object to
                control subscription.
            </p>
            <h2>
                Unsubscribe
            </h2>
            <p>
                Unsubscribing to a <strong>remote stream</strong> is done by the
                <code>Conversation.unsubscribeToStream(streamId)</code> method.
            </p>
            <app-codenav [code]="unsubscribe" [(language)]="lang"></app-codenav>
            <h2>
                Manage media streams
            </h2>
            <p>
                Once a <strong>stream</strong> has been subscribed, <strong>ApiRTC</strong> notifies with an actual
                <code>Stream</code> instance through the <code>streamAdded</code> event.
            </p>
            <p>
                This event is triggered every time the actual media stream is available to be displayed.
            </p>
            <app-codenav [code]="streamAdded" [(language)]="lang"></app-codenav>
            <p>
                Whenever a <code>media stream</code> becomes unavailable, <strong>ApiRTC</strong> notifies the
                <strong>conversation</strong> with a <code>streamRemoved</code> event.
            </p>
            <app-codenav [code]="streamRemoved" [(language)]="lang"></app-codenav>
            <div class="alert alert-warning" role="alert">
                <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Warning:">
                    <use xlink:href="#exclamation-triangle-fill"></use>
                </svg>
                <span>
                    A <code>media stream</code> may encounter technical issues, or meet network optimization requiring
                    to change the actual <code>Stream</code> instance.
                    In this case <code>streamRemoved</code> event will be also fired, prior to another
                    <code>streamAdded</code> event with the new instance.
                </span>
            </div>
            <h1 class="mt-5">
                <a #anchor id="stream-display" class="anchor"></a>
                Stream display
            </h1>
            <p>
                In order to display or remove media element in DOM, you can use our helpers:
            </p>
            <ul>
                <li>
                    addInDiv() and removeFromDiv() to work within an element
                </li>
                <li>
                    <code>Stream.attachToElement(domElement)</code> to directly attach to a <code>&lt;video&gt;</code>
                    element.
                </li>
            </ul>
            <p>
                We manage some devices specificities in our helpers that can help avoid media plays issue for instance
                with Safari iOS.
            </p>
            <app-codenav [code]="displayStream" [(language)]="lang"></app-codenav>
            <h1 class="mt-5">
                <a #anchor id="stream-capabilities" class="anchor"></a>
                Stream capabilities
            </h1>
            <h2 class="mt-3">
                <a #anchor id="capabilities-local" class="anchor"></a>
                Local stream
            </h2>
            <div class="alert alert-warning" role="alert">
                This method may not work with all browsers. Also, returned capabilities may differ from a device to
                another.
            </div>
            <p><strong>Stream capabilities</strong> are accessible camera properties that can be modified, e.g.,
                brightness, contrast, frameRate, saturation, torch, zoom.</p>
            <p><strong>ApiRTC</strong> allows to control them through <code>Stream</code> methods:
                <code>getCapabilities</code>, <code>getSettings</code>, <code>getConstraints</code>, and
                <code>setCapability</code>.
            </p>

            <p class="mt-3"><code>Stream.getCapabilities()</code>, combined with <code>streamCapabilities</code> event
                provide an event data object with all available capabilities and their accepted values ranges:
            </p>
            <div class="row">
                <div class="col-lg-6">
                    <app-codenav [code]="capabilitiesGetCapabilities" [(language)]="lang"></app-codenav>
                </div>
            </div>
            <div class="row">
                <div class="col-6">
                    <p>To get the result, listen the <code>streamCapabilities</code> event:</p>
                    <app-codenav [code]="capabilitiesGetCapabilitiesListen" [(language)]="lang"></app-codenav>
                </div>
                <div class="col border-start">
                    <p>Example of a <code>capabilities</code> data object:</p>
                    <pre><code [highlight]="capabilitiesGetCapabilitiesResult" [languages]="['json']"></code></pre>
                    <p>In this example <code>frameRate</code> capability may be modified between 0 and
                        30.000000305175.</p>
                </div>
            </div>

            <p class="mt-3"><code>Stream.getSettings()</code>, combined with <code>streamSettings</code> event allows to
                get an event data object with all available capabilities and their actual values. If a capability is not
                in the data object it means the device and/or the navigator does not handle this capability:</p>
            <div class="row">
                <div class="col-6">
                    <app-codenav [code]="capabilitiesGetSettings" [(language)]="lang"></app-codenav>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <p>To get the result, listen the <code>streamSettings</code> event:</p>
                    <app-codenav [code]="capabilitiesGetSettingsListen" [(language)]="lang"></app-codenav>
                </div>
                <div class="col border-start">
                    <p>Example of a <code>settings</code> data object:</p>
                    <pre><code [highlight]="capabilitiesGetSettingsResult" [languages]="['json']"></code></pre>
                    <p>In this example <code>frameRate</code> is a supported capability and it's actual value is 30.
                        <code>zoom</code> is not a supported capability for this combination of device/camera/navigator
                        as it is not present in the returned object.
                    </p>
                    <div class="alert alert-warning" role="alert">
                        Capabilities are linked to the camera used, changing it also change the returned capabilities.
                        On smartphones with multiple back cameras, sometimes the torch capability is only attached to
                        one of them.
                    </div>
                </div>
            </div>

            <p class="mt-3"><code>Stream.getConstraints()</code>, combined with <code>streamConstraints</code> event
                provides a data object with all capabilities that were modified from their default value and their
                actual values:</p>
            <div class="row">
                <div class="col-6">
                    <app-codenav [code]="capabilitiesGetConstraints" [(language)]="lang"></app-codenav>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <p>To get the result, listen the <code>streamConstraints</code> event:</p>
                    <app-codenav [code]="capabilitiesGetConstraintsListen" [(language)]="lang"></app-codenav>
                </div>
                <div class="col border-start">
                    <p>Example of a <code>constraints</code> data object if <code>frameRate</code> capability was
                        modified to 10fps:</p>
                    <pre><code [highlight]="capabilitiesGetConstraintsResult" [languages]="['json']"></code></pre>
                </div>
            </div>

            <p class="mt-3">To modify a capability value use the <code>setCapability</code> function as below:</p>
            <div class="row">
                <div class="col-6">
                    <app-codenav [code]="setCapability" [(language)]="lang"></app-codenav>
                </div>
            </div>

            <h2 class="mt-3">
                <a #anchor id="capabilities-remote" class="anchor"></a>
                Remote stream
            </h2>
            <p>On a remote stream you may use all the previous functions explained for a local stream the
                exact same way, except for the <code>setCapability</code> method for a non-intrusive reason.
            </p>
            <p>The usage of <code>setCapability</code> is the same, but it will throw an error saying you
                need to ask authorization to the remote user before using this method.</p>
            <p class="mt-3">Here is what you need to do to ask the authorization to the remote user to perform
                <code>setCapability</code> calls in his name on his device:
            </p>
            <div class="row">
                <div class="col-6">
                    <app-codenav [code]="remoteCapability" [(language)]="lang"></app-codenav>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col">
                    <p>Then, listen <code>remoteCapabilityRequestAccepted</code> and
                        <code>remoteCapabilityRequestRefused</code> events:
                    </p>
                    <app-codenav [code]="remoteCapabilityListen" [(language)]="lang"></app-codenav>
                </div>
                <div class="col border-start">
                    <p>Here is what the remote user needs to do to handle your request, and to accept or
                        refuse it. Listen the <code>remoteCapabilityRequest</code> event, and answer by
                        accepting using <code>acceptRemoteCapabilityRequest</code> function or refuse using
                        <code>refuseRemoteCapabilityRequest</code> function.
                    </p>
                    <app-codenav [code]="remoteRequest" [(language)]="lang"></app-codenav>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col">
                    <p>If the remote user accepted the remote capability control you may perform
                        <code>setCapability</code> calls without error:
                    </p>
                    <app-codenav [code]="remoteSetCapability" [(language)]="lang"></app-codenav>
                    <p>In this particular case of remote <code>setCapability</code> usage the promise is released
                        when the order has been send to the remote user to execute the <code>setCapability</code>
                        function, not when the capability has been set.</p>
                </div>
            </div>
            <h1 class="mt-5">
                <a #anchor id="qos-statistics" class="anchor"></a>
                QoS statistics
            </h1>
            <p>
                <code>Conversation</code> event <code>callStatsUpdate</code> provides statistics information
                on
                <strong>media stream</strong> exchanges quality of service.
            </p>
            <app-codenav [code]="callStatsUpdate" [(language)]="lang"></app-codenav>
            <p>
                Depending on whether the stream is <strong>sent</strong> or <strong>received</strong>, the
                event data
                object (<code>callStats</code>) holds the following information:
            </p>
            <div class="row">
                <div class="col">
                    <p class="text-center">
                        For a <strong>local stream</strong>, qos info on sent media
                    </p>
                    <pre><code [highlight]="stats_sent" [languages]="['json']"></code></pre>
                </div>
                <div class="col">
                    <p class="text-center">
                        For a <strong>remote stream</strong>, qos info on received media
                    </p>
                    <pre><code [highlight]="stats_received" [languages]="['json']"></code></pre>
                </div>
            </div>
            <p>
                The <code>callStats.streamId</code> is useful to associate data to corresponding
                <strong>stream</strong>.
            </p>
            <h1 class="mt-5">
                <a #anchor id="speaker-detection" class="anchor"></a>
                Speaker detection
            </h1>
            <p>
                To display which participant is currently talking in a <code>Conversation</code>, enable the
                feature:
            </p>
            <app-codenav [code]="enableActiveSpeakerDetecting" [(language)]="lang"></app-codenav>
            <p>
                Then, listen on the <code>audioAmplitude</code> event:
            </p>
            <app-codenav [code]="audioAmplitude" [(language)]="lang"></app-codenav>
            <p>
                the event data object (<code>amplitudeInfo</code>) holds the following information:
            </p>
            <pre><code [highlight]="amplitudeInfo" [languages]="['json']"></code></pre>
            <p>
                When the participant speaks and <code>amplitude</code> goes over the <code>threshold</code>
                configured
                during feature enabling, event with <code>isSpeaking</code> set to <strong>true</strong> is
                fired.
            </p>
            <p>
                When the participant does not speak anymore, the event is fired again with initial
                <code>amplitude</code> value that triggered the event, but this time <code>isSpeaking</code>
                is
                <strong>false</strong>.
            </p>
            <h1 class="mt-5">
                <a #anchor id="mute" class="anchor"></a>
                Audio/Video Mute
            </h1>
            <p>
                To control <strong>local or remote stream</strong> audio/video mute, use the following
                <code>Stream</code>
                methods:
            </p>
            <app-codenav [code]="toggleAudioVideoMute" [(language)]="lang"></app-codenav>
            <h1 class="mt-5">
                <a #anchor id="whiteboard" class="anchor"></a>
                Whiteboard
            </h1>
            <p>
                Explain Whiteboard
            </p>
            <h1 class="mt-5">
                <a #anchor id="recording" class="anchor"></a>
                Recording
            </h1>
            <!-- <p>
                TODO : Recording locally one stream...
            </p> -->
            <p>
                <strong>ApiRTC</strong> platform allows to record a composite video of a
                <strong>conversation</strong>.
                The video will be composed of all streams exchanged in the <strong>conversation</strong> and
                will be
                stored in <strong>ApiRTC</strong>'s database.
            </p>
            <p>To start recording a <strong>conversation</strong>:</p>

            <div class="row align-items-center mt-3">
                <div class="col">
                    <app-codenav [code]="startRecording" [(language)]="lang"></app-codenav>
                </div>
                <div class="col border-start">
                    <p>
                        Refer to <a class="text-nowrap"
                            href="https://dev.apirtc.com/reference/Conversation.html#startRecording" target="_blank"
                            rel="noopener"><code>startRecording(options)</code>&nbsp;<span
                                class="material-icons align-middle fs-6">open_in_new</span></a> for
                        <code>options</code> details.
                    </p>
                </div>
            </div>
            <p>
                Example of <code>recordingInfo</code> (<a class="text-nowrap"
                    href="https://dev.apirtc.com/reference/global.html#RecordingInfo" target="_blank"
                    rel="noopener"><code>RecordingInfo</code>&nbsp;<span
                        class="material-icons align-middle fs-6">open_in_new</span></a>):
            </p>
            <pre><code [highlight]="recordingInfo" [languages]="['json']"></code></pre>
            <p>To stop recording a <strong>conversation</strong>:</p>
            <app-codenav [code]="stopRecording" [(language)]="lang"></app-codenav>
            <p>Once the recording is stopped, the <strong>ApiRTC</strong> platform wil process it and make
                it available
                for download. To get notified when a record is available:</p>
            <app-codenav [code]="recordingAvailable" [(language)]="lang"></app-codenav>
            <p>When the video is available, you can use the <code>RecordingInfo.mediaURL</code> to download
                it.</p>
            <div class="alert alert-info d-flex align-items-center" role="alert">
                <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Info:">
                    <use xlink:href="#info-fill"></use>
                </svg>
                <div>
                    Manage your recorded medias from your <strong>ApiRTC</strong> account <a class="text-nowrap"
                        href="https://cloud.apirtc.com/media-manager" title="Media Manager" target="_blank"
                        rel="noopener">Media-Manager&nbsp;<span
                            class="material-icons align-middle fs-6">open_in_new</span></a>
                </div>
            </div>

            <h1 class="mt-5">
                <a #anchor id="chat-messages" class="anchor"></a>
                Chat messages
            </h1>
            <p>
                Explain Chat messages
            </p>
            <h1 class="mt-5">
                <a #anchor id="background-subtraction" class="anchor"></a>
                Background subtraction
            </h1>
            <p>
                <strong>ApiRTC</strong> allows to create a background blurred stream based on an original
                stream using <code>Stream.blur()</code>.
            </p>
            <p>To start the blur process on a <strong>stream</strong> :</p>
            <app-codenav [code]="blur" [(language)]="lang"></app-codenav>
            <p>The returned blurred stream is a an instance of <code>Stream</code> and is a copy of the base
                stream with a blur process applied on it. It means that there is a strong dependance between
                the child and his parent (e.g. If the parent audio is muted the child audio will be too, if
                the parent is released the child also). Both streams needs to be handled by the application
                to keep the blur process going on.</p>
            <p>Then, use the blurred stream as a local stream :</p>
            <app-codenav [code]="blurPublish" [(language)]="lang"></app-codenav>

            <p>To stop the blur process :</p>
            <app-codenav [code]="blurStop" [(language)]="lang"></app-codenav>
            <p>Both methods have the same result, the only difference is the object on which you call the
                method.</p>
            <h1 class="mt-5">
                <a #anchor id="good-practices" class="anchor"></a>
                Good practices
            </h1>
            <p>
                Explain Good practices
            </p>
            <h2 class="mt-3">
                <a #anchor id="uptodate" class="anchor"></a>
                Keeping Up-to-Date
            </h2>
        </div>
    </div>
</div>